import pandas as pd
import sqlite3
import sys

def import_schedule_from_excel():
    """–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏–∑ Excel —Ñ–∞–π–ª–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö"""
    try:
        # –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
        conn = sqlite3.connect('school.db')
        cursor = conn.cursor()
        
        # –ß–∏—Ç–∞–µ–º Excel —Ñ–∞–π–ª
        excel_path = '–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ —É—á–∏—Ç–µ–ª—è–º2025_2026.xlsx'
        df = pd.read_excel(excel_path, sheet_name=1, header=None)
        
        # –ü–∞—Ä—Å–∏–º –¥–∞–Ω–Ω—ã–µ (–Ω—É–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –≤–∞—à—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É Excel)
        print("üìä –ù–∞—á–∏–Ω–∞–µ–º –∏–º–ø–æ—Ä—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è...")
        
        # –í–ê–ñ–ù–û: –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤–∞—à–µ–≥–æ Excel —Ñ–∞–π–ª–∞
        # –ù—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤–∞—à–µ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
        
        print("‚úÖ –ò–º–ø–æ—Ä—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω!")
        
        conn.commit()
        conn.close()
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è: {e}")
        sys.exit(1)

if __name__ == "__main__":
    print("‚ö†Ô∏è  –í–Ω–∏–º–∞–Ω–∏–µ: –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Ç—Ä–µ–±—É–µ—Ç –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–¥ –≤–∞—à —Ñ–æ—Ä–º–∞—Ç Excel —Ñ–∞–π–ª–∞")
    print("üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∞—à–µ–≥–æ Excel —Ñ–∞–π–ª–∞:")
    print("   - –£—á–∏—Ç–µ–ª—è –≤ —Å—Ç–æ–ª–±—Ü–µ B (–Ω–∞—á–∏–Ω–∞—è —Å —Å—Ç—Ä–æ–∫–∏ 7)")
    print("   - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ –¥–Ω—è–º –∏ —É—Ä–æ–∫–∞–º –≤ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö")
    print("\nüîÑ –ù–∞—á–∏–Ω–∞–µ–º –∏–º–ø–æ—Ä—Ç...")
    import_schedule_from_excel()